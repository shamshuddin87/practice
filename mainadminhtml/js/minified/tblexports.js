
(function(i){"function"===typeof define&&define.amd?define(["jquery","datatables.net","datatables.net-buttons"],function(g){return i(g,window,document)}):"object"===typeof exports?module.exports=function(g,k,q,r){g||(g=window);if(!k||!k.fn.dataTable)k=require("datatables.net")(g,k).$;k.fn.dataTable.Buttons||require("datatables.net-buttons")(g,k);return i(k,g,g.document,q,r)}:i(jQuery,window,document)})(function(i,g,k,q,r,p){function y(a,c){s===p&&(s=-1===v.serializeToString(i.parseXML(z["xl/worksheets/sheet1.xml"])).indexOf("xmlns:r"));i.each(c,function(c,b){if(i.isPlainObject(b)){var e=a.folder(c);y(e,b)}else{if(s){var e=b.childNodes[0],f,h,m=[];for(f=e.attributes.length-1;0<=f;f--){h=e.attributes[f].nodeName;var g=e.attributes[f].nodeValue;-1!==h.indexOf(":")&&(m.push({name:h,value:g}),e.removeAttribute(h))}f=0;for(h=m.length;f<h;f++)g=b.createAttribute(m[f].name.replace(":","_dt_b_namespace_token_")),g.value=m[f].value,e.setAttributeNode(g)}e=v.serializeToString(b);s&&(-1===e.indexOf("<?xml")&&(e='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+
e),e=e.replace(/_dt_b_namespace_token_/g,":"));e=e.replace(/<(.*?) xmlns=""(.*?)>/g,"<$1 $2>");a.file(c,e)}})}function n(a,c,d){var b=a.createElement(c);d&&(d.attr&&i(b).attr(d.attr),d.children&&i.each(d.children,function(a,c){b.appendChild(c)}),d.text&&b.appendChild(a.createTextNode(d.text)));return b}function I(a,c){var d=a.header[c].length,b;a.footer&&a.footer[c].length>d&&(d=a.footer[c].length);for(var e=0,f=a.body.length;e<f&&!(b=a.body[e][c].toString(),-1!==b.indexOf("\n")?(b=b.split("\n"),b.sort(function(a,b){return b.length-a.length}),b=b[0].length):b=b.length,b>d&&(d=b),40<d);e++);d*=1.3;return 6<d?d:6}var l=i.fn.dataTable,o;var h="undefined"!==typeof self&&self||"undefined"!==typeof g&&g||this.content;if("undefined"===typeof h||"undefined"!==typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))o=void 0;else{var t=h.document.createElementNS("http://www.w3.org/1999/xhtml","a"),J="download"in t,K=/constructor/i.test(h.HTMLElement)||h.safari,A=/CriOS\/[\d]+/.test(navigator.userAgent),L=function(a){(h.setImmediate||h.setTimeout)(function(){throw a;},0)},B=function(a){setTimeout(function(){"string"===typeof a?(h.URL||h.webkitURL||h).revokeObjectURL(a):a.remove()},4E4)},C=function(a){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob([String.fromCharCode(65279),a],{type:a.type}):a},D=function(a,c,d){d||(a=C(a));var b=this,d="application/octet-stream"===a.type,e,f=function(){for(var a=["writestart","progress","write","writeend"],a=[].concat(a),c=a.length;c--;){var d=b["on"+a[c]];if("function"===typeof d)try{d.call(b,b)}catch(e){L(e)}}};b.readyState=b.INIT;if(J)e=(h.URL||h.webkitURL||h).createObjectURL(a),setTimeout(function(){t.href=e;t.download=c;var a=new MouseEvent("click");t.dispatchEvent(a);f();B(e);b.readyState=b.DONE});else if((A||d&&K)&&h.FileReader){var i=new FileReader;i.onloadend=function(){var a=A?i.result:i.result.replace(/^data:[^;]*;/,"data:attachment/file;");h.open(a,"_blank")||(h.location.href=a);b.readyState=b.DONE;f()};i.readAsDataURL(a);b.readyState=b.INIT}else e||(e=(h.URL||h.webkitURL||h).createObjectURL(a)),d?h.location.href=e:h.open(e,"_blank")||(h.location.href=e),b.readyState=b.DONE,f(),B(e)},j=D.prototype;"undefined"!==typeof navigator&&navigator.msSaveOrOpenBlob?o=function(a,c,d){c=c||a.name||"download";d||(a=C(a));return navigator.msSaveOrOpenBlob(a,c)}:(j.abort=function(){},j.readyState=j.INIT=0,j.WRITING=1,j.DONE=2,j.error=j.onwritestart=j.onprogress=j.onwrite=j.onabort=j.onerror=j.onwriteend=null,o=function(a,c,d){return new D(a,c||a.name||"download",d)})}l.fileSave=o;var u=function(a,c){var d="*"===a.filename&&"*"!==a.title&&a.title!==p?a.title:a.filename;"function"===typeof d&&(d=d());-1!==d.indexOf("*")&&(d=i.trim(d.replace("*",i("title").text())));d=d.replace(/[^a-zA-Z0-9_\u00A1-\uFFFF\.,\-_ !\(\)]/g,"");return c===p||!0===c?d+a.extension:d},M=function(a){var c="Sheet1";a.sheetName&&(c=a.sheetName.replace(/[\[\]\*\/\\\?\:]/g,""));return c},N=function(a){a=a.title;"function"===typeof a&&(a=a());return-1!==a.indexOf("*")?a.replace("*",i("title").text()||"Exported data"):a},E=function(a){return a.newline?a.newline:navigator.userAgent.match(/Windows/)?"\r\n":"\n"},F=function(a,c){for(var d=E(c),b=a.buttons.exportData(c.exportOptions),e=c.fieldBoundary,f=c.fieldSeparator,i=RegExp(e,"g"),m=c.escapeChar!==p?c.escapeChar:"\\",h=function(a){for(var b="",c=0,d=a.length;c<d;c++)0<c&&(b+=f),b+=e?e+(""+a[c]).replace(i,m+e)+e:a[c];return b},g=c.header?h(b.header)+d:"",k=c.footer&&b.footer?d+
h(b.footer):"",w=[],x=0,j=b.body.length;x<j;x++)w.push(h(b.body[x]));return{str:g+w.join(d)+k,rows:w.length}},G=function(){if(!(-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&-1===navigator.userAgent.indexOf("Opera")))return!1;var a=navigator.userAgent.match(/AppleWebKit\/(\d+\.\d+)/);return a&&1<a.length&&603.1>1*a[1]?!0:!1};try{var v=new XMLSerializer,s}catch(O){}var z={"_rels/.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/></Relationships>',"xl/_rels/workbook.xml.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet1.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/></Relationships>',"[Content_Types].xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="xml" ContentType="application/xml" /><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml" /><Default Extension="jpeg" ContentType="image/jpeg" /><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml" /><Override PartName="/xl/worksheets/sheet1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml" /><Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml" /></Types>',"xl/workbook.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><fileVersion appName="xl" lastEdited="5" lowestEdited="5" rupBuild="24816"/><workbookPr showInkAnnotation="0" autoCompressPictures="0"/><bookViews><workbookView xWindow="0" yWindow="0" windowWidth="25600" windowHeight="19020" tabRatio="500"/></bookViews><sheets><sheet name="" sheetId="1" r:id="rId1"/></sheets></workbook>',"xl/worksheets/sheet1.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"><sheetData/></worksheet>',"xl/styles.xml":'<?xml version="1.0" encoding="UTF-8"?><styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"><numFmts count="6"><numFmt numFmtId="164" formatCode="#,##0.00_- [$$-45C]"/><numFmt numFmtId="165" formatCode="&quot;£&quot;#,##0.00"/><numFmt numFmtId="166" formatCode="[$€-2] #,##0.00"/><numFmt numFmtId="167" formatCode="0.0%"/><numFmt numFmtId="168" formatCode="#,##0;(#,##0)"/><numFmt numFmtId="169" formatCode="#,##0.00;(#,##0.00)"/></numFmts><fonts count="5" x14ac:knownFonts="1"><font><sz val="11" /><name val="Calibri" /></font><font><sz val="11" /><name val="Calibri" /><color rgb="FFFFFFFF" /></font><font><sz val="11" /><name val="Calibri" /><b /></font><font><sz val="11" /><name val="Calibri" /><i /></font><font><sz val="11" /><name val="Calibri" /><u /></font></fonts><fills count="6"><fill><patternFill patternType="none" /></fill><fill/><fill><patternFill patternType="solid"><fgColor rgb="FFD9D9D9" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="FFD99795" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="ffc6efce" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="ffc6cfef" /><bgColor indexed="64" /></patternFill></fill></fills><borders count="2"><border><left /><right /><top /><bottom /><diagonal /></border><border diagonalUp="false" diagonalDown="false"><left style="thin"><color auto="1" /></left><right style="thin"><color auto="1" /></right><top style="thin"><color auto="1" /></top><bottom style="thin"><color auto="1" /></bottom><diagonal /></border></borders><cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" /></cellStyleXfs><cellXfs count="67"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="left"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="center"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="right"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="fill"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment textRotation="90"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment wrapText="1"/></xf><xf numFmtId="9"   fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="164" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="165" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="166" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="167" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="168" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="169" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="3" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="4" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="1" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="2" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/></cellXfs><cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0" /></cellStyles><dxfs count="0" /><tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4" /></styleSheet>'},H=[{match:/^\-?\d+\.\d%$/,style:60,fmt:function(a){return a/100}},{match:/^\-?\d+\.?\d*%$/,style:56,fmt:function(a){return a/100}},{match:/^\-?\$[\d,]+.?\d*$/,style:57},{match:/^\-?£[\d,]+.?\d*$/,style:58},{match:/^\-?€[\d,]+.?\d*$/,style:59},{match:/^\-?\d+$/,style:65},{match:/^\-?\d+\.\d{2}$/,style:66},{match:/^\([\d,]+\)$/,style:61,fmt:function(a){return-1*a.replace(/[\(\)]/g,"")}},{match:/^\([\d,]+\.\d{2}\)$/,style:62,fmt:function(a){return-1*a.replace(/[\(\)]/g,"")}},{match:/^\-?[\d,]+$/,style:63},{match:/^\-?[\d,]+\.\d{2}$/,style:64}];l.ext.buttons.copyHtml5={className:"buttons-copy buttons-html5",text:function(a){return a.i18n("buttons.copy","Copy")},action:function(a,c,d,b){var a=F(c,b),e=a.str,d=i("<div/>").css({height:1,width:1,overflow:"hidden",position:"fixed",top:0,left:0});b.customize&&(e=b.customize(e,b));b=i("<textarea readonly/>").val(e).appendTo(d);if(k.queryCommandSupported("copy")){d.appendTo(c.table().container());b[0].focus();b[0].select();try{var f=k.execCommand("copy");d.remove();if(f){c.buttons.info(c.i18n("buttons.copyTitle","Copy to clipboard"),c.i18n("buttons.copySuccess",{1:"Copied one row to clipboard",_:"Copied %d rows to clipboard"},a.rows),2E3);return}}catch(h){}}f=i("<span>"+c.i18n("buttons.copyKeys","Press <i>ctrl</i> or <i>⌘</i> + <i>C</i> to copy the table data<br>to your system clipboard.<br><br>To cancel, click this message or press escape.")+"</span>").append(d);c.buttons.info(c.i18n("buttons.copyTitle","Copy to clipboard"),f,0);b[0].focus();b[0].select();var m=i(f).closest(".dt-button-info"),g=function(){m.off("click.buttons-copy");i(k).off(".buttons-copy");c.buttons.info(!1)};m.on("click.buttons-copy",g);i(k).on("keydown.buttons-copy",function(a){27===a.keyCode&&g()}).on("copy.buttons-copy cut.buttons-copy",function(){g()})},exportOptions:{},fieldSeparator:"\t",fieldBoundary:"",header:!0,footer:!1};l.ext.buttons.csvHtml5={bom:!1,className:"buttons-csv buttons-html5",available:function(){return g.FileReader!==p&&g.Blob},text:function(a){return a.i18n("buttons.csv","CSV")},action:function(a,c,d,b){a=F(c,b).str;c=b.charset;b.customize&&(a=b.customize(a,b));!1!==c?(c||(c=k.characterSet||k.charset),c&&(c=";charset="+c)):c="";b.bom&&(a="﻿"+a);o(new Blob([a],{type:"text/csv"+c}),u(b),!0)},filename:"*",extension:".csv",exportOptions:{},fieldSeparator:",",fieldBoundary:'"',escapeChar:'"',charset:null,header:!0,footer:!1};l.ext.buttons.excelHtml5={className:"buttons-excel buttons-html5",available:function(){return g.FileReader!==p&&(q||g.JSZip)!==p&&!G()&&v},text:function(a){return a.i18n("buttons.excel","Excel")},action:function(a,c,d,b){var e=0,a=function(a){return i.parseXML(z[a])},f=a("xl/worksheets/sheet1.xml"),h=f.getElementsByTagName("sheetData")[0],a={_rels:{".rels":a("_rels/.rels")},xl:{_rels:{"workbook.xml.rels":a("xl/_rels/workbook.xml.rels")},"workbook.xml":a("xl/workbook.xml"),"styles.xml":a("xl/styles.xml"),worksheets:{"sheet1.xml":f}},"[Content_Types].xml":a("[Content_Types].xml")},c=c.buttons.exportData(b.exportOptions),m,k,d=function(a){m=e+1;k=n(f,"row",{attr:{r:m}});for(var b=0,c=a.length;b<c;b++){for(var d=b,g="";0<=d;)g=String.fromCharCode(d%26+65)+g,d=Math.floor(d/26)-1;var d=g+""+m,j=null;if(!(null===a[b]||a[b]===p||""===a[b])){a[b]=i.trim(a[b]);for(var l=0,o=H.length;l<o;l++)if(g=H[l],a[b].match&&a[b].match(g.match)){j=a[b].replace(/[^\d\.\-]/g,"");g.fmt&&(j=g.fmt(j));j=n(f,"c",{attr:{r:d,s:g.style},children:[n(f,"v",{text:j})]});break}j||("number"===typeof a[b]||a[b].match&&a[b].match(/^-?\d+(\.\d+)?$/)&&!a[b].match(/^0\d+/)?j=n(f,"c",{attr:{t:"n",r:d},children:[n(f,"v",{text:a[b]})]}):(g=!a[b].replace?a[b]:a[b].replace(/[\x00-\x09\x0B\x0C\x0E-\x1F\x7F-\x9F]/g,""),j=n(f,"c",{attr:{t:"inlineStr",r:d},children:{row:n(f,"is",{children:{row:n(f,"t",{text:g})}})}})));k.appendChild(j)}}h.appendChild(k);e++};i("sheets sheet",a.xl["workbook.xml"]).attr("name",M(b));b.customizeData&&b.customizeData(c);b.header&&(d(c.header,e),i("row c",f).attr("s","2"));for(var j=0,l=c.body.length;j<l;j++)d(c.body[j],e);b.footer&&c.footer&&(d(c.footer,e),i("row:last c",f).attr("s","2"));d=n(f,"cols");i("worksheet",f).prepend(d);j=0;for(l=c.header.length;j<l;j++)d.appendChild(n(f,"col",{attr:{min:j+1,max:j+1,width:I(c,j),customWidth:1}}));b.customize&&b.customize(a);c=new(q||g.JSZip);d={type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};y(c,a);c.generateAsync?c.generateAsync(d).then(function(a){o(a,u(b))}):o(c.generate(d),u(b))},filename:"*",extension:".xlsx",exportOptions:{},header:!0,footer:!1};l.ext.buttons.pdfHtml5={className:"buttons-pdf buttons-html5",available:function(){return g.FileReader!==p&&(r||g.pdfMake)},text:function(a){return a.i18n("buttons.pdf","PDF")},action:function(a,c,d,b){E(b);var a=c.buttons.exportData(b.exportOptions),e=[];b.header&&e.push(i.map(a.header,function(a){return{text:"string"===typeof a?a:a+"",style:"tableHeader"}}));for(var f=0,h=a.body.length;f<h;f++)e.push(i.map(a.body[f],function(a){return{text:"string"===typeof a?a:a+"",style:f%2?"tableBodyEven":"tableBodyOdd"}}));b.footer&&a.footer&&e.push(i.map(a.footer,function(a){return{text:"string"===typeof a?a:a+"",style:"tableFooter"}}));a={pageSize:b.pageSize,pageOrientation:b.orientation,content:[{table:{headerRows:1,body:e},layout:"noBorders"}],styles:{tableHeader:{bold:!0,fontSize:11,color:"white",fillColor:"#2d4154",alignment:"center"},tableBodyEven:{},tableBodyOdd:{fillColor:"#f3f3f3"},tableFooter:{bold:!0,fontSize:11,color:"white",fillColor:"#2d4154"},title:{alignment:"center",fontSize:15},message:{}},defaultStyle:{fontSize:10}};b.message&&a.content.unshift({text:"function"==typeof b.message?b.message(c,d,b):b.message,style:"message",margin:[0,0,0,12]});b.title&&a.content.unshift({text:N(b,!1),style:"title",margin:[0,0,0,12]});b.customize&&b.customize(a,b);c=(r||g.pdfMake).createPdf(a);"open"===b.download&&!G()?c.open():c.getBuffer(function(a){a=new Blob([a],{type:"application/pdf"});o(a,u(b))})},title:"*",filename:"*",extension:".pdf",exportOptions:{},orientation:"portrait",pageSize:"A4",header:!0,footer:!1,message:null,customize:null,download:"download"};return l.Buttons});;;(function(root,factory){if(typeof exports==='object'&&typeof exports.nodeName!=='string'){module.exports=root.document?factory(root,true):function(w){if(!w.document){throw new Error("FileSaver requires a window with a document");}
return factory(w);};}else{factory(root);}}(window||this,function(window,noGlobal){"use strict";if(typeof window==="undefined"||typeof navigator!=="undefined"&&/MSIE [1-9]\./.test(navigator.userAgent)){return;}
var
doc=window.document,get_URL=function(){return window.URL||window.webkitURL||window;},save_link=doc.createElementNS("http://www.w3.org/1999/xhtml","a"),can_use_save_link="download"in save_link,click=function(node){var event=new MouseEvent("click");node.dispatchEvent(event);},is_safari=/constructor/i.test(window.HTMLElement)||window.safari,is_chrome_ios=/CriOS\/[\d]+/.test(navigator.userAgent),throw_outside=function(ex){(window.setImmediate||window.setTimeout)(function(){throw ex;},0);},force_saveable_type="application/octet-stream",arbitrary_revoke_timeout=1000*40,revoke=function(file){var revoker=function(){if(typeof file==="string"){get_URL().revokeObjectURL(file);}else{file.remove();}};setTimeout(revoker,arbitrary_revoke_timeout);},dispatch=function(filesaver,event_types,event){event_types=[].concat(event_types);var i=event_types.length;while(i--){var listener=filesaver["on"+event_types[i]];if(typeof listener==="function"){try{listener.call(filesaver,event||filesaver);}catch(ex){throw_outside(ex);}}}},auto_bom=function(blob){if(/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(blob.type)){return new Blob([String.fromCharCode(0xFEFF),blob],{type:blob.type});}
return blob;},FileSaver=function(blob,name,no_auto_bom){if(!no_auto_bom){blob=auto_bom(blob);}
var
filesaver=this,type=blob.type,force=type===force_saveable_type,object_url,dispatch_all=function(){dispatch(filesaver,"writestart progress write writeend".split(" "));},fs_error=function(){if((is_chrome_ios||(force&&is_safari))&&window.FileReader){var reader=new FileReader();reader.onloadend=function(){var url=is_chrome_ios?reader.result:reader.result.replace(/^data:[^;]*;/,'data:attachment/file;');var popup=window.open(url,'_blank');if(!popup)window.location.href=url;url=undefined;filesaver.readyState=filesaver.DONE;dispatch_all();};reader.readAsDataURL(blob);filesaver.readyState=filesaver.INIT;return;}
if(!object_url){object_url=get_URL().createObjectURL(blob);}
if(force){window.location.href=object_url;}else{var opened=window.open(object_url,"_blank");if(!opened){window.location.href=object_url;}}
filesaver.readyState=filesaver.DONE;dispatch_all();revoke(object_url);};filesaver.readyState=filesaver.INIT;if(can_use_save_link){object_url=get_URL().createObjectURL(blob);setTimeout(function(){save_link.href=object_url;save_link.download=name;click(save_link);dispatch_all();revoke(object_url);filesaver.readyState=filesaver.DONE;});return;}
fs_error();},FS_proto=FileSaver.prototype,saveAs=function(blob,name,no_auto_bom){return new FileSaver(blob,name||blob.name||"download",no_auto_bom);};if(typeof navigator!=="undefined"&&navigator.msSaveOrOpenBlob){saveAs=function(blob,name,no_auto_bom){name=name||blob.name||"download";if(!no_auto_bom){blob=auto_bom(blob);}
return navigator.msSaveOrOpenBlob(blob,name);};}
FS_proto.abort=function(){};FS_proto.readyState=FS_proto.INIT=0;FS_proto.WRITING=1;FS_proto.DONE=2;FS_proto.error=FS_proto.onwritestart=FS_proto.onprogress=FS_proto.onwrite=FS_proto.onabort=FS_proto.onerror=FS_proto.onwriteend=null;if(typeof define==="function"&&define.amd){define("file-saverjs",[],function(){return saveAs;});}
if(typeof noGlobal==='undefined'){window.saveAs=saveAs;}
return saveAs;}));;;(function(root,factory){if(typeof define==='function'&&define.amd){define(function(require){var $;try{$=require('jquery')}catch(e){}
return factory($,require('blobjs'),require('file-saverjs'),require('xlsx'));});}else if(typeof exports==='object'&&typeof exports.nodeName!=='string'){var $;try{$=require('jquery')}catch(e){}
module.exports=factory($,require('blobjs'),require('file-saverjs'),require('xlsx'));}else{root.TableExport=factory(root.jQuery,root.Blob,root.saveAs,root.XLSX);}}(this,function($,Blob,saveAs,XLSX){'use strict';var TableExport=function(selectors,options){var self=this;if(!selectors)return _handleError('"selectors" is required. \nUsage: TableExport(selectors, options)');if(!self)return new TableExport(selectors,options);self.settings=_extend({},self.defaults,options);self.selectors=_nodesArray(selectors);var settings=self.settings;settings.ignoreRows=settings.ignoreRows instanceof Array?settings.ignoreRows:[settings.ignoreRows];settings.ignoreCols=settings.ignoreCols instanceof Array?settings.ignoreCols:[settings.ignoreCols];settings.ignoreCSS=self.ignoreCSS instanceof Array?self.ignoreCSS:[self.ignoreCSS];settings.emptyCSS=self.emptyCSS instanceof Array?self.emptyCSS:[self.emptyCSS];settings.formatValue=self.formatValue.bind(this,settings.trimWhitespace);settings.bootstrapSettings=_getBootstrapSettings(settings.bootstrap,self.bootstrapConfig,self.defaultButton);var _exportData={};self.getExportData=function(){return _exportData;};self.selectors.forEach(function(el){var context={};context.rows=_nodesArray(el.querySelectorAll('tbody > tr'));context.rows=settings.headers?_nodesArray(el.querySelectorAll('thead > tr')).concat(context.rows):context.rows;context.rows=settings.footers?context.rows.concat(_nodesArray(el.querySelectorAll('tfoot > tr'))):context.rows;context.thAdj=settings.headers?el.querySelectorAll('thead > tr').length:0;context.filename=settings.filename==='id'?(el.getAttribute('id')?el.getAttribute('id'):self.defaultFilename):(settings.filename?settings.filename:self.defaultFilename);context.uuid=_uuid(el);context.checkCaption=function(exportButton){var caption=el.querySelectorAll('caption.'+self.defaultCaptionClass);if(caption.length){caption[0].appendChild(exportButton);}else{caption=document.createElement('caption');caption.className=settings.bootstrapSettings.bootstrapSpacing+settings.position+' '+self.defaultCaptionClass;caption.appendChild(exportButton);el.insertBefore(caption,el.firstChild);}};context.setExportData=(function(){return function(exporter){var data=Storage.getInstance().getItem(exporter);var type=exporter.substring(exporter.indexOf('-')+1);_exportData[context.uuid]=_exportData[context.uuid]||{};_exportData[context.uuid][type]=JSON.parse(data);};})();context.rcMap=new RowColMap().build(context,settings);var formatMap=_FORMAT_LIST.reduce(function(acc,cur){acc[cur]=0;return acc;},{});settings.formats.forEach(function(key){if(!_isValidFormat(key)){return _handleError('"'+key+'" is not a valid format. \nFormats: '+_FORMAT_LIST.join(', '))}else if(!_hasDependencies(key)){return _handleError('"'+key+'" requires "js-xlsx".');}else if(!formatMap[key]){context.setExportData(self.exporters.build.call(self,context,key));formatMap[key]++;}});});var exportButton=document.querySelectorAll('button['+self.storageKey+']');_on(exportButton,'click',self.downloadHandler,self);return self;};TableExport.prototype={version:'5.0.0',defaults:{headers:true,footers:true,formats:['xlsx','csv','txt'],filename:'id',bootstrap:false,exportButtons:true,position:'bottom',ignoreRows:null,ignoreCols:null,trimWhitespace:true},CONSTANTS:{FORMAT:{XLSX:'xlsx',XLSM:'xlsm',XLSB:'xlsb',BIFF2:'biff2',XLS:'xls',CSV:'csv',TXT:'txt'},TYPE:{STRING:'s',NUMBER:'n',BOOLEAN:'b',DATE:'d'}},charset:'charset=utf-8',defaultFilename:'myDownload',defaultButton:'button-default',defaultCaptionClass:'tableexport-caption',defaultNamespace:'tableexport-',tableKey:'tableexport-key',storageKey:'tableexport-id',ignoreCSS:'.tableexport-ignore',emptyCSS:'.tableexport-empty',bootstrapConfig:['btn','btn-default','btn-toolbar'],rowDel:'\r\n',entityMap:{'&':'&#38;','<':'&#60;','>':'&#62;',"'":'&#39;','/':'&#47;'},formatConfig:{xlsx:{defaultClass:'xlsx',buttonContent:'Export to xlsx',mimeType:'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',fileExtension:'.xlsx'},xlsm:{defaultClass:'xlsm',buttonContent:'Export to xlsm',mimeType:'application/vnd.ms-excel.sheet.macroEnabled.main+xml',fileExtension:'.xlsm'},xlsb:{defaultClass:'xlsb',buttonContent:'Export to xlsb',mimeType:'application/vnd.ms-excel.sheet.binary.macroEnabled.main',fileExtension:'.xlsb'},xls:{defaultClass:'xls',buttonContent:'Export to xls',separator:'\t',mimeType:'application/vnd.ms-excel',fileExtension:'.xls',enforceStrictRFC4180:false},csv:{defaultClass:'csv',buttonContent:'Export to csv',separator:',',mimeType:'text/csv',fileExtension:'.csv',enforceStrictRFC4180:true},txt:{defaultClass:'txt',buttonContent:'Export to txt',separator:'  ',mimeType:'text/plain',fileExtension:'.txt',enforceStrictRFC4180:true}},typeConfig:{string:{defaultClass:'tableexport-string'},number:{defaultClass:'tableexport-number',assert:function(v){return!isNaN(v);}},boolean:{defaultClass:'tableexport-boolean',assert:function(v){return v.toLowerCase()==='true'||v.toLowerCase()==='false';}},date:{defaultClass:'tableexport-date',assert:function(v){return!(/.*%/.test(v))&&!isNaN(Date.parse(v))}}},exporters:{build:function(context,key){var self=this;var settings=self.settings;var format=self.formatConfig[key];var colDel=format.separator;var rcMap=context.rcMap;var getReturn=function(val){if(_isEnhanced(key)){return{v:settings.formatValue(val.textContent),t:self.getType(val.className)}}
switch(key){case _FORMAT.CSV:return'"'+settings.formatValue(val.textContent.replace(/"/g,'""'))+'"';default:return settings.formatValue(val.textContent);}};var dataURI=_nodesArray(context.rows).map(function(val,ir){if(rcMap.isIgnore(ir)){return rcMap.handleRowColMapProp(rcMap.TYPE.IGNORE);}else if(rcMap.isEmpty(ir)){return rcMap.handleRowColMapProp(rcMap.TYPE.EMPTY);}
var cols=val.querySelectorAll('th, td');return _nodesArray(cols).map(function(val,ic){var _return=getReturn(val);if(rcMap.isIgnore(ir,ic)){return rcMap.handleRowColMapProp(rcMap.TYPE.IGNORE);}else if(rcMap.isEmpty(ir,ic)){return rcMap.handleRowColMapProp(rcMap.TYPE.EMPTY);}else{return rcMap.handleRowColMapProp(rcMap.TYPE.DEFAULT,ir,ic,key,_return,colDel);}}).processCols(key,colDel);}).processRows(key,self.rowDel);var dataObject=JSON.stringify({data:dataURI,filename:context.filename,mimeType:format.mimeType,fileExtension:format.fileExtension,merges:rcMap.merges});var hashKey=_hashCode({uuid:context.uuid,type:key});settings.exportButtons&&context.checkCaption(self.createObjButton(hashKey,dataObject,format.buttonContent,format.defaultClass,settings.bootstrapSettings));return Storage.getInstance().setItem(hashKey,dataObject,true);}},createObjButton:function(hashKey,dataObject,myContent,myClass,bootstrapSettings){var exportButton=document.createElement('button');exportButton.setAttribute(this.storageKey,hashKey);exportButton.className=bootstrapSettings.bootstrapClass+bootstrapSettings.bootstrapTheme+myClass;exportButton.textContent=myContent;return exportButton},escapeHtml:function(string){var self=this;return String(string).replace(/[&<>'\/]/g,function(s){return self.entityMap[s];});},unescapeHtml:function(string){var str=String(string);for(var key in this.entityMap){str=str.replace(RegExp(this.entityMap[key],'g'),key);}
return str;},formatValue:function(isTrimWhitespace,string){return isTrimWhitespace?string.trim():string;},getType:function(string){if(!string)return'';var types=this.typeConfig;if(~string.indexOf(types.string.defaultClass)){return _TYPE.STRING;}else if(~string.indexOf(types.number.defaultClass)){return _TYPE.NUMBER;}else if(~string.indexOf(types.boolean.defaultClass)){return _TYPE.BOOLEAN;}else if(~string.indexOf(types.date.defaultClass)){return _TYPE.DATE;}else{return'';}},dateNum:function(v,date1904){if(date1904)v+=1462;var epoch=Date.parse(v);var result=(epoch-new Date(Date.UTC(1899,11,30)))/(24*60*60*1000);return Math.floor(result);},createSheet:function(data,merges){var ws={};var range={s:{c:10000000,r:10000000},e:{c:0,r:0}};var types=this.typeConfig;for(var R=0;R!==data.length;++R){for(var C=0;C!==data[R].length;++C){if(range.s.r>R)range.s.r=R;if(range.s.c>C)range.s.c=C;if(range.e.r<R)range.e.r=R;if(range.e.c<C)range.e.c=C;var cell=data[R][C];if(!cell||!cell.v)continue;var cell_ref=XLSX.utils.encode_cell({c:C,r:R});if(!cell.t){if(types.number.assert(cell.v))cell.t=_TYPE.NUMBER;else if(types.boolean.assert(cell.v))cell.t=_TYPE.BOOLEAN;else if(types.date.assert(cell.v))cell.t=_TYPE.DATE;else cell.t=_TYPE.STRING;}
if(cell.t===_TYPE.DATE){cell.t=_TYPE.NUMBER;cell.z=XLSX.SSF._table[14];cell.v=this.dateNum(cell.v);}
ws[cell_ref]=cell;}}
ws['!merges']=merges;if(range.s.c<10000000)ws['!ref']=XLSX.utils.encode_range(range);return ws;},downloadHandler:function(event){var target=event.target;var object=JSON.parse(Storage.getInstance().getItem(target.getAttribute(this.storageKey))),data=object.data,filename=object.filename,mimeType=object.mimeType,fileExtension=object.fileExtension,merges=object.merges;this.export2file(data,mimeType,filename,fileExtension,merges);},Workbook:function(){this.SheetNames=[];this.Sheets={};},string2ArrayBuffer:function(s){var buf=new ArrayBuffer(s.length);var view=new Uint8Array(buf);for(var i=0;i!==s.length;++i)view[i]=s.charCodeAt(i)&0xFF;return buf;},export2file:function(data,mime,name,extension,merges){data=this.getRawData(data,extension,name,merges);if(_isMobile){var dataURI='data:'+mime+';'+this.charset+','+data;this.downloadDataURI(dataURI,name,extension);}else{saveAs(new Blob([data],{type:mime+';'+this.charset}),name+extension,true);}},downloadDataURI:function(dataURI,name,extension){var encodedUri=encodeURI(dataURI);var link=document.createElement('a');link.setAttribute('href',encodedUri);link.setAttribute('download',name+extension);document.body.appendChild(link);link.click();},getBookType:function(key){switch(key){case _FORMAT.XLS:return _FORMAT.BIFF2;default:return key;}},getRawData:function(data,extension,name,merges){var key=extension.substring(1);if(_isEnhanced(key)){var wb=new this.Workbook(),ws=this.createSheet(data,merges),bookType=this.getBookType(key);name=name||'';wb.SheetNames.push(name);wb.Sheets[name]=ws;var wopts={bookType:bookType,bookSST:false,type:'binary'},wbout=XLSX.write(wb,wopts);data=this.string2ArrayBuffer(wbout);}
return data;},getFileSize:function(data,extension){var binary=this.getRawData(data,extension);return binary instanceof ArrayBuffer?binary.byteLength:this.string2ArrayBuffer(binary).byteLength;},update:function(options){this.remove();return new TableExport(this.selectors,_extend({},this.defaults,options));},reset:function(){this.remove();return new TableExport(this.selectors,this.settings);},remove:function(){var self=this;this.selectors.forEach(function(el){var caption=el.querySelector('caption.'+self.defaultCaptionClass);caption&&el.removeChild(caption);});}};var Storage=function(){this._instance=null;this.store=sessionStorage;this.namespace=TableExport.prototype.defaultNamespace;this.getKey=function(key){return this.namespace+key;};this.setItem=function(_key,value,overwrite){var key=this.getKey(_key);if(this.exists(_key)&&!overwrite){return;}
if(typeof value!=='string')return _handleError('"value" must be a string.');this.store.setItem(key,value);return _key;};this.getItem=function(_key){var key=this.getKey(_key);return this.store.getItem(key);};this.exists=function(_key){var key=this.getKey(_key);return this.store.getItem(key)!==null;};this.removeItem=function(_key){var key=this.getKey(_key);return this.store.removeItem(key);};};Storage.getInstance=function(){if(!this._instance){this._instance=new Storage();}
return this._instance;};var RowColMap=function(){this.rcMap=[];this.merges=[];this.isIgnore=function(ir,ic){var _ignore=RowColMap.prototype.TYPE.IGNORE;return this.getRowColMapProp(ir,ic,_ignore);};this.isEmpty=function(ir,ic){var _empty=RowColMap.prototype.TYPE.EMPTY;return this.getRowColMapProp(ir,ic,_empty);};this.isRowSpan=function(ir){var _rowspan=RowColMap.prototype.TYPE.ROWSPAN;return this.getRowColMapProp(ir,undefined,_rowspan);};this.isColSpan=function(ir){var _colspan=RowColMap.prototype.TYPE.COLSPAN;return this.getRowColMapProp(ir,undefined,_colspan);};this.isSpan=function(ir){return this.isRowSpan(ir)||this.isColSpan(ir);};this.isMerge=function(ir){return this.merges.length>0;};this.addMerge=function(ir,mergeObj){var _merge=RowColMap.prototype.TYPE.MERGE;this.merges.push(mergeObj);this.setRowColMapProp(ir,undefined,_merge,this.merges);};this.getRowColMapProp=function(ir,ic,key){if(this.rcMap[ir]){if(typeof key==='undefined'){return this.rcMap[ir][ic];}else if(typeof ic==='undefined'){return this.rcMap[ir][key];}else if(this.rcMap[ir][ic]){return this.rcMap[ir][ic][key];}}
return undefined;};this.setRowColMapProp=function(ir,ic,key,value){this.rcMap[ir]=this.rcMap[ir]||[];if(typeof key==='undefined'){return this.rcMap[ir][ic]=value;}else if(typeof ic==='undefined'){return this.rcMap[ir][key]=value;}else{this.rcMap[ir][ic]=this.rcMap[ir][ic]||[];return this.rcMap[ir][ic][key]=value;}};this.generateTotal=function(ir,ic){var VALUE=RowColMap.prototype.TYPE.VALUE;var _total=0;if(this.isRowSpan(ir)&&this.isColSpan(ir)){_total=this.getRowColMapProp(ir,ic,VALUE)||0;}else if(this.getRowColMapProp(ir,ic,VALUE)){_total=this.getRowColMapProp(ir,ic,VALUE);}
return _total;};this.convertSpanToArray=function(ir,ic,key,_return,colDel){if(this.rcMap[ir]&&this.isSpan(ir)){var total=this.generateTotal(ir,ic);if(_isEnhanced(key)){return new Array(total).concat(_return);}else{return new Array(total).concat(_return).join(colDel);}}
return _return;};this.handleRowColMapProp=function(type,ir,ic,key,_return,colDel){switch(type){case RowColMap.prototype.TYPE.IGNORE:return;case RowColMap.prototype.TYPE.EMPTY:return' ';case RowColMap.prototype.TYPE.DEFAULT:default:return this.convertSpanToArray(ir,ic,key,_return,colDel);}};};RowColMap.prototype={OFFSET:1,TYPE:{IGNORE:'ignore',EMPTY:'empty',MERGE:'merge',ROWSPAN:'rowspan',ROWSPANTOTAL:'rowspantotal',COLSPAN:'colspan',COLSPANTOTAL:'colspantotal',DEFAULT:'default',VALUE:'value'},build:function(context,settings){var self=this;var OFFSET=self.OFFSET;var rowLength=self.rowLength=context.rows.length;var handleIgnore=function(ir,ic){self.setRowColMapProp(ir,ic,self.TYPE.IGNORE,true);};var handleEmpty=function(ir,ic){self.setRowColMapProp(ir,ic,self.TYPE.EMPTY,true);};var handleRowSpan=function(val,ir,ic){var rowSpan=+val.getAttribute('rowspan');var colSpan=+val.getAttribute('colspan');var handledByColSpan,countRowSpan,countColSpan,totalRowSpan,totalColSpan,irStart,irEnd,icStart,icEnd;for(var _row=0;_row<rowSpan;_row++){if(_row+ir>=rowLength){return;}
colSpan&&(handledByColSpan=handleColSpan(val,_row+ir,ic,_row>0,rowSpan));if(rowSpan<=1){return false;}
var cur=self.rcMap['c'+(ic-1)]?self.rcMap['c'+(ic-1)][_row+ir]:0;if(cur){self.rcMap['c'+(ic)]=self.rcMap['c'+(ic)]||[];self.rcMap['c'+(ic)][_row+ir]=(self.rcMap['c'+(ic)][_row+ir]||0)+cur;}
if(rowSpan&&_row===0&&colSpan>1){for(var i=0;i<rowSpan;i++){self.rcMap['c'+(ic+1)]=self.rcMap['c'+(ic+1)]||[];self.rcMap['c'+(ic+1)][_row+ir+i]=(self.rcMap['c'+(ic+1)][_row+ir+i]||0)+Math.max(1,colSpan);}}
if(_row>=1){countRowSpan=self.getRowColMapProp(_row+ir,undefined,self.TYPE.ROWSPAN)||0;self.setRowColMapProp(_row+ir,undefined,self.TYPE.ROWSPAN,countRowSpan+1);if(!handledByColSpan){totalRowSpan=self.getRowColMapProp(_row+ir,ic-countRowSpan,self.TYPE.VALUE)||0;self.setRowColMapProp(_row+ir,ic-countRowSpan,self.TYPE.VALUE,totalRowSpan+1);if(rowSpan>1&&_row===1){var _re=self.rcMap['c'+(ic)]&&self.rcMap['c'+(ic)][_row+ir];totalColSpan=self.getRowColMapProp(ir,undefined,self.TYPE.COLSPANTOTAL)||0;countColSpan=self.getRowColMapProp(ir,undefined,self.TYPE.COLSPAN)||0;irStart=ir;irEnd=ir+rowSpan-1;icStart=ic+totalColSpan-countColSpan+(_re||0);icEnd=icStart+Math.max(1,colSpan)-1;handleMerge(irStart,icStart,irEnd,icEnd);}}}}};var handleColSpan=function(val,ir,ic,isRowSpan,rowSpan){var irStart,irEnd,icStart,icEnd;var colSpan=+val.getAttribute('colspan');var countColSpan=self.getRowColMapProp(ir,undefined,self.TYPE.COLSPAN)||0;var totalColSpan=self.getRowColMapProp(ir,undefined,self.TYPE.COLSPANTOTAL)||0;if(colSpan<=1){return false;}
self.setRowColMapProp(ir,undefined,self.TYPE.COLSPAN,countColSpan+1);self.setRowColMapProp(ir,undefined,self.TYPE.COLSPANTOTAL,totalColSpan+colSpan);if(isRowSpan){self.setRowColMapProp(ir,ic-countColSpan,self.TYPE.VALUE,colSpan);return true;}else{irStart=ir;irEnd=ir+(rowSpan||1)-OFFSET;icStart=ic+totalColSpan-countColSpan;icEnd=ic+totalColSpan-countColSpan+(colSpan-OFFSET);self.setRowColMapProp(ir,ic+OFFSET,self.TYPE.VALUE,colSpan-OFFSET);handleMerge(irStart,icStart,irEnd,icEnd);}};var handleMerge=function(irs,ics,ire,ice){var merge={s:{r:irs,c:ics},e:{r:ire,c:ice}};return self.addMerge(irs,merge);};_nodesArray(context.rows).map(function(val,ir){if(!!~settings.ignoreRows.indexOf(ir-context.thAdj)||_matches(val,settings.ignoreCSS)){handleIgnore(ir);}
if(_matches(val,settings.emptyCSS)){handleEmpty(ir);}
var cols=val.querySelectorAll('th, td');return _nodesArray(cols).map(function(val,ic){if(!!~settings.ignoreCols.indexOf(ic)||_matches(val,settings.ignoreCSS)){handleIgnore(ir,ic);}
if(_matches(val,settings.emptyCSS)){handleEmpty(ir,ic);}
if(val.hasAttribute('rowspan')){handleRowSpan(val,ir,ic);}else if(val.hasAttribute('colspan')){handleColSpan(val,ir,ic);}});});return self;}};var _isMobile=(function isMobile(ua){return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge|maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm(os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(ua)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(ua.substring(0,4))})(navigator.userAgent||navigator.vendor||window.opera);var _isEnhanced=(function(){return function(key){return(XLSX&&!_isMobile&&!(TableExport.prototype.formatConfig[key].enforceStrictRFC4180));}})();var _FORMAT=(function(){return TableExport.prototype.CONSTANTS.FORMAT;})();var _FORMAT_LIST=(function(){return Object.keys(_FORMAT).map(function(key){return _FORMAT[key];});})();var _TYPE=(function(){return TableExport.prototype.CONSTANTS.TYPE;})();Array.prototype.processRows=function(key,rowDel){if(_isEnhanced(key)){return this.map(_toArray).filter(_defined);}else{return this.filter(_defined).join(rowDel);}};Array.prototype.processCols=function(key,colDel){if(_isEnhanced(key)){return this.filter(_defined);}else{return this.filter(_defined).join(colDel);}};var _uuid=(function(){var uuid=0;return function(el){var tableKey=el.getAttribute(TableExport.prototype.tableKey);if(!tableKey){tableKey=el.id?el.id:TableExport.prototype.defaultNamespace+(++uuid);el.setAttribute(TableExport.prototype.tableKey,tableKey);}
return tableKey;};})();var _hashCode=(function(){return function(hashKey){var hash=0,i,char;var type=hashKey.type;hashKey=JSON.stringify(hashKey);if(hashKey.length===0)return hash;for(i=0;i<hashKey.length;i++){char=hashKey.charCodeAt(i);hash=((hash<<5)-hash)+char;hash|=0;}
return hash.toString(16).substring(1)+'-'+type;}})();var _on=(function(){var prevFn=null;return function(el,event,fn,context){var curFn=fn.bind(context);for(var i=0;i<el.length;++i){prevFn&&el[i].removeEventListener(event,prevFn,false);el[i].addEventListener(event,curFn,false);}
prevFn=curFn;}})();function _extend(){var args=arguments;for(var i=1;i<args.length;i++)
for(var key in args[i])
if(args[i].hasOwnProperty(key))
args[0][key]=args[i][key];return args[0];}
function _nodesArray(els){return(typeof els.length==='undefined')?[].concat(els):[].slice.call(els);}
function _hasClass(el,cls){return el.classList?el.classList.contains(cls):new RegExp('(^| )'+cls+'( |$)','gi').test(el.cls);}
function _matches(el,selectors){return selectors.filter(function(selector){return[].indexOf.call(document.querySelectorAll(selector),el)!==-1;}).length>0;}
function _numeric(val){return!isNaN(val);}
function _defined(val){return typeof val!=='undefined';}
function _toArray(val){return val instanceof Array?[].concat.apply([],val):val;}
function _isValidFormat(key){return~_FORMAT_LIST.indexOf(key);}
function _hasDependencies(key){var hasDependencies;switch(key){case _FORMAT.TXT:case _FORMAT.CSV:case _FORMAT.XLS:hasDependencies=true;break;default:hasDependencies=_isEnhanced(key);}
return hasDependencies}
function _handleError(msg){console.error(msg);return new Error(msg)}
function _getBootstrapSettings(bootstrap,bootstrapConfig,defaultButton){var config={};if(bootstrap){config.bootstrapClass=bootstrapConfig[0]+' ';config.bootstrapTheme=bootstrapConfig[1]+' ';config.bootstrapSpacing=bootstrapConfig[2]+' ';}else{config.bootstrapClass=defaultButton+' ';config.bootstrapTheme='';config.bootstrapSpacing='';}
return config;}
if($){$.fn.tableExport=function(options){return new TableExport(this,options);};for(var prop in TableExport.prototype){$.fn.tableExport[prop]=TableExport.prototype[prop];}}
TableExport.TableExport=TableExport;return TableExport;}));;